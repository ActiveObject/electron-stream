<!DOCTYPE html>
<html>
  <body>
    <script>
      var qs = require('querystring');
      var ipc = require('ipc');

      var log = console.log;
      console.log = function(){
        ipc.send('stdout', [].slice.call(arguments));
        log.apply(console, arguments);
      };

      var error = console.error;
      console.error = function(){
        ipc.send('stderr', [].slice.call(arguments));
        error.apply(console, arguments);
      };

      process.on('uncaughtException', function(err){
        if (process.listeners('uncaughtException').length != 1) return;

        console.error(err.stack);
        window.close();
      });

      var opts = qs.parse(location.search.slice(1));
      require(opts.source);
    </script>
  </body>
</html>
